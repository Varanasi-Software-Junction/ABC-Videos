<!doctype html>

<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Intersection Observer — Local demo</title>
<style>
  :root{--bg:#f6f6f8;--card:#fff;--accent:#0b6cf2}
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:var(--bg);color:#111}
  header{padding:24px 20px;background:linear-gradient(90deg,#fff, #f8fbff);box-shadow:0 1px 0 rgba(0,0,0,0.04);position:sticky;top:0;z-index:30}
  header h1{margin:0;font-size:18px}
  main{max-width:980px;margin:28px auto;padding:0 20px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px}
  .card{background:var(--card);border-radius:12px;overflow:hidden;min-height:180px;display:flex;flex-direction:column;align-items:stretch;box-shadow:0 6px 18px rgba(13,38,76,0.06);transform:translateY(12px);opacity:0;transition:transform .6s cubic-bezier(.2,.9,.25,1),opacity .6s ease}
  .card.in-view{transform:none;opacity:1}
  .media{height:180px;background:#eee;display:flex;align-items:center;justify-content:center}
  .media img{max-width:100%;max-height:100%;display:block}
  .media video{width:100%;height:100%;object-fit:cover;display:block;background:#000}
  .body{padding:14px}
  .title{font-weight:600;margin:0 0 8px 0}
  .desc{font-size:13px;color:#444;margin:0}/* small helper for placeholder boxes */ .placeholder{width:96px;height:64px;background:linear-gradient(90deg,#eee,#f6f6f6);border-radius:6px}

/* subtle focus outline */ a:focus{outline:3px solid rgba(11,108,242,0.14);outline-offset:3px}

/* reveal animation for children */ .reveal{opacity:0;transform:translateY(10px);transition:opacity .45s ease, transform .45s ease} .card.in-view .reveal{opacity:1;transform:none}

/* small footer */ footer{max-width:980px;margin:32px auto;color:#666;padding:0 20px 60px}

/* Responsive tweaks */ @media (max-width:520px){.media{height:160px}} </style>

</head>
<body>
<header>
  <h1>IntersectionObserver — Local SVGs & Placeholder Videos (demo)</h1>
</header>
<main>
  <p>Sections below lazy-load local SVG images and videos when they enter the viewport. Videos are loaded and played only when visible and paused otherwise.</p>  <div class="grid" id="grid">
    <!-- We'll create a few cards. Each media tag uses data-src and data-type. Replace files in /assets/ with your local files. --><article class="card" data-id="1">
  <div class="media">
    <img class="lazy-img" data-src="assets/illustration-1.svg" alt="Illustration 1" width="640" height="360">
  </div>
  <div class="body">
    <h3 class="title reveal">Local SVG — Illustration 1</h3>
    <p class="desc reveal">This image is an SVG file kept locally (assets/illustration-1.svg). It is only loaded when the card intersects.</p>
  </div>
</article>

<article class="card" data-id="2">
  <div class="media">
    <!-- video will be populated from data-src when visible -->
    <video class="lazy-video" preload="none" playsinline muted loop data-src="assets/placeholder-1.mp4" poster="assets/video-poster-1.jpg" width="640" height="360"></video>
  </div>
  <div class="body">
    <h3 class="title reveal">Placeholder Video 1</h3>
    <p class="desc reveal">A local MP4 placeholder video (assets/placeholder-1.mp4). Video source added when the card is visible to save bandwidth.</p>
  </div>
</article>

<article class="card" data-id="3">
  <div class="media">
    <img class="lazy-img" data-src="assets/illustration-2.svg" alt="Illustration 2" width="640" height="360">
  </div>
  <div class="body">
    <h3 class="title reveal">Local SVG — Illustration 2</h3>
    <p class="desc reveal">Another local SVG loaded through IntersectionObserver.</p>
  </div>
</article>

<article class="card" data-id="4">
  <div class="media">
    <video class="lazy-video" preload="none" playsinline muted loop data-src="assets/placeholder-2.mp4" poster="assets/video-poster-2.jpg" width="640" height="360"></video>
  </div>
  <div class="body">
    <h3 class="title reveal">Placeholder Video 2</h3>
    <p class="desc reveal">Second video — also local. Plays only when visible.</p>
  </div>
</article>

  </div>
</main><footer>
  Tip: Place your local assets in a folder named <code>assets/</code> next to this HTML file. Example files you can create for testing:
  <ul>
    <li><code>assets/illustration-1.svg</code> and <code>assets/illustration-2.svg</code> — any simple SVGs</li>
    <li><code>assets/placeholder-1.mp4</code> and <code>assets/placeholder-2.mp4</code> — short sample MP4s (muted for autoplay)</li>
    <li><code>assets/video-poster-1.jpg</code> and <code>assets/video-poster-2.jpg</code> — optional poster images</li>
  </ul>
  To run: open this file in your browser or serve it from a simple static server (recommended for video playback). Example: <code>npx http-server .</code>
</footer><script>
// IntersectionObserver setup
const ioOptions = { root: null, rootMargin: '0px 0px 120px 0px', threshold: 0.2 };

function onIntersect(entries, obs){
  entries.forEach(entry => {
    const el = entry.target;
    if(entry.isIntersecting){
      // add class to animate
      el.classList.add('in-view');

      // load images
      const img = el.querySelector('.lazy-img');
      if(img && !img.src){
        img.src = img.dataset.src;
        img.addEventListener('load', ()=> img.classList.add('loaded'));
      }

      // load video source and play
      const vid = el.querySelector('.lazy-video');
      if(vid && !vid.src){
        // set src and try to play
        vid.src = vid.dataset.src;
        // try to play once metadata is ready
        vid.addEventListener('loadedmetadata', async () => {
          try{ await vid.play(); } catch(e){ /* autoplay may be blocked — muted allowed above */ }
        }, {once:true});
      }

    } else {
      // out of view: pause video to save CPU
      const vid = el.querySelector('.lazy-video');
      if(vid && !vid.paused){
        try{ vid.pause(); } catch(e){}
      }
    }
  });
}

const observer = new IntersectionObserver(onIntersect, ioOptions);

// observe all cards
document.querySelectorAll('.card').forEach(card => observer.observe(card));

// Optional: prefetch first two items to improve perceived load
window.addEventListener('DOMContentLoaded', ()=>{
  const cards = document.querySelectorAll('.card');
  cards.forEach((c,i)=>{
    if(i<1){ // preload first card image/video immediately (change as needed)
      const img = c.querySelector('.lazy-img');
      if(img) img.src = img.dataset.src;
      const vid = c.querySelector('.lazy-video');
      if(vid){ vid.src = vid.dataset.src; vid.load(); }
    }
  });
});
</script></body>
</html>