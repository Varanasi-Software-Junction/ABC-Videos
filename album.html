<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Photos — KashiFrame Studios</title>
  <link rel="stylesheet" href="https://varanasi-software-junction.github.io/blogger/blogger-assets/crx_styles_v1.css">
  <style>
    :root{
      --saffron:#b7410e;
      --bg:#fff;
      --muted:#666;
      --row-gap:180px;
      --caption-bg: rgba(0,0,0,0.6);
    }

    html,body{
      height:100%;
      margin:0;
      font-family:"Poppins",system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      color:#222;
      background:#fff;
      scroll-behavior:smooth;
    }

    header{
      background:linear-gradient(135deg,#ffecd2,#fcb69f);
      padding:18px 16px;
      box-shadow:0 6px 20px rgba(0,0,0,0.05)
    }
    .container{max-width:1300px;margin:24px auto;padding:0 16px}
    .back{display:inline-block;margin-bottom:10px;color:var(--saffron);text-decoration:none}
    h1{margin:6px 0 8px}

    main.container{
      scroll-snap-type: y mandatory;
      scroll-padding-top: 24px;
    }

    .gallery-section{
      position:relative;
      scroll-snap-align:start;
      margin-bottom:var(--row-gap);
      padding:80px 0;
    }
    .row{
      display:flex;
      gap:12px;
      align-items:stretch;
      justify-content:center;
      transition:box-shadow 800ms ease;
      transform-origin:center top;
      z-index:10;
      position:relative;
      will-change:transform;
      contain: paint; /* helps isolate visual paint, avoids some layout effects */
    }

    .tile{
      flex:1 1 240px;
      min-width:220px;
      border-radius:12px;
      overflow:hidden;
      background:#f6f6f6;
      transition:transform 800ms cubic-bezier(.22,.9,.32,1),box-shadow 800ms ease;
      box-shadow:0 6px 18px rgba(0,0,0,0.04);
      position:relative;
    }
    .tile img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 1.4s ease-in-out}
    .tile:hover img{transform:scale(1.06)}
    .tile .meta{position:absolute;left:8px;bottom:8px;background:linear-gradient(180deg,rgba(0,0,0,0.08),rgba(0,0,0,0.35));color:#fff;padding:6px 8px;border-radius:8px;font-size:0.9rem}

    /* Base sticky rise (visual only) */
    .row.active{
      position:-webkit-sticky;
      position:sticky;
      top:40px;
      z-index:60;
      box-shadow:0 40px 70px rgba(0,0,0,0.2);
    }
    .row.active .tile{
      transform:scale(1.03);
      box-shadow:0 30px 60px rgba(0,0,0,0.18);
    }

    /* Slide */
    @keyframes slideRise {
      0% { transform: translateX(-24vw) translateY(0) rotate(0deg) scale(1); opacity:1; }
      60% { transform: translateX(-6vw) translateY(-6vh) rotate(-1deg) scale(1.01); opacity:1; }
      100% { transform: translateX(0) translateY(-8vh) rotate(0deg) scale(1.02); opacity:1; }
    }
    .row.effect-slide.active { animation: slideRise 900ms cubic-bezier(.22,.9,.32,1) both; }

    /* Rotate */
    @keyframes rotateRise {
      0% { transform: translateY(0) rotate(6deg) scale(1); opacity:1; }
      60% { transform: translateY(-5vh) rotate(2deg) scale(1.01); opacity:1; }
      100% { transform: translateY(-8vh) rotate(-1.2deg) scale(1.02); opacity:1; }
    }
    .row.effect-rotate.active { animation: rotateRise 900ms cubic-bezier(.22,.9,.32,1) both; }

    /* Fade dip */
    @keyframes fadeDipRise {
      0% { transform: translateY(0) scale(1); opacity:1; }
      30% { transform: translateY(-2vh) scale(0.995); opacity:0; }
      70% { transform: translateY(-5vh) scale(1.005); opacity:0.45; }
      100% { transform: translateY(-8vh) scale(1.02); opacity:1; }
    }
    .row.effect-fade.active { animation: fadeDipRise 1100ms cubic-bezier(.22,.9,.32,1) both; }

    .row.effect-slide.active .tile,
    .row.effect-rotate.active .tile,
    .row.effect-fade.active .tile {
      transition: transform 900ms cubic-bezier(.22,.9,.32,1);
      transform-origin:center;
    }

    .row-caption{
      position:fixed;
      top:20px;
      right:28px;
      background:var(--caption-bg);
      color:#fff;
      padding:12px 18px;
      border-radius:10px;
      font-weight:600;
      font-size:1.05rem;
      box-shadow:0 12px 30px rgba(0,0,0,0.28);
      opacity:0;
      transform:translateY(-10px) scale(0.98);
      transition:opacity 420ms ease,transform 420ms cubic-bezier(.22,.9,.32,1);
      pointer-events:none;
      z-index:200;
      max-width:46%;
      backdrop-filter:blur(6px);
    }
    .row-caption.show{opacity:1;transform:translateY(0) scale(1)}
    .row-caption .sub{display:block;font-size:0.85rem;opacity:0.9;font-weight:400;margin-top:4px}

    @media(max-width:980px){
      .row{flex-wrap:wrap}
      .tile{flex:1 1 calc(50% - 12px)}
      .row-caption{right:16px;left:16px;bottom:18px;top:auto;text-align:center;max-width:unset}
    }
    @media(max-width:520px){
      .tile{flex:1 1 100%}
      .row.active{position:relative;transform:none;top:auto}
    }

    footer{margin-top:80px;padding:18px;text-align:center;color:var(--muted)}

    .expander{position:fixed;inset:0;pointer-events:none;z-index:40;display:block;overflow:hidden;will-change:opacity,transform}
    .expander .layer{position:absolute;inset:0;background-position:center;background-size:cover;transform-origin:center;transition:transform 5s cubic-bezier(.22,.9,.32,1),opacity 4.8s ease-in-out;will-change:transform,opacity;opacity:0;filter:none}
    .expander .layer.base{z-index:1;transition-duration:5s;opacity:0.95}
    .expander .layer.blur{z-index:2;filter:blur(16px) saturate(120%);opacity:0.6;transition-duration:5.5s;transform:scale(1.05)}
    .expander .layer.glaze{z-index:3;background-blend-mode:overlay;opacity:0.25;transition-duration:6s;transform:scale(1.12);background-color:rgba(183,65,14,0.18)}
    .expander.show .layer.base{transform:scale(1.02);opacity:1}
    .expander.show .layer.blur{transform:scale(1.12);opacity:0.85}
    .expander.show .layer.glaze{transform:scale(1.18);opacity:0.45}

    @media (prefers-reduced-motion: reduce){
      .expander .layer, .row, .tile img, .row-caption, .row.effect-slide.active, .row.effect-rotate.active, .row.effect-fade.active {
        transition:none!important; transform:none!important; animation:none!important; opacity:1!important; filter:none!important;
      }
    }

    main,header,footer{position:relative;z-index:50}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <a class="back" href="index.html">← Back to Home</a>
      <h1>Photo Albums</h1>
      <p style="max-width:820px">Scroll — each row will lift and pick a random entrance, but page scrolling is left entirely to the user.</p>
    </div>
  </header>

  <main class="container" id="main">
    <div id="gallery">
      <!-- rows -->
      <section class="gallery-section" data-caption="Ghats & Morning Life">
        <div class="row">
          <figure class="tile"><img src="pics/0.jpg" alt=""><figcaption class="meta">Ghats — Sunrise</figcaption></figure>
          <figure class="tile"><img src="pics/1.jpg" alt=""><figcaption class="meta">Wedding — Varanasi</figcaption></figure>
          <figure class="tile"><img src="pics/2.jpg" alt=""><figcaption class="meta">Aerial — Old City</figcaption></figure>
          <figure class="tile"><img src="pics/me.jpg" alt=""><figcaption class="meta">Street — Market</figcaption></figure>
        </div>
      </section>

      <section class="gallery-section" data-caption="Weddings & Rituals">
        <div class="row">
          <figure class="tile"><img src="pics/1.jpg" alt=""><figcaption class="meta">Bride — Ghats</figcaption></figure>
          <figure class="tile"><img src="pics/2.jpg" alt=""><figcaption class="meta">Aerial — Sunset</figcaption></figure>
          <figure class="tile"><img src="pics/me.jpg" alt=""><figcaption class="meta">Street — Art</figcaption></figure>
          <figure class="tile"><img src="pics/0.jpg" alt=""><figcaption class="meta">Ghats — Twilight</figcaption></figure>
        </div>
      </section>

      <section class="gallery-section" data-caption="Aerial & Cityscapes">
        <div class="row">
          <figure class="tile"><img src="pics/2.jpg" alt=""><figcaption class="meta">Aerial — Over Ghats</figcaption></figure>
          <figure class="tile"><img src="pics/1.jpg" alt=""><figcaption class="meta">Wedding — Lamps</figcaption></figure>
          <figure class="tile"><img src="pics/me.jpg" alt=""><figcaption class="meta">Street — Vendors</figcaption></figure>
          <figure class="tile"><img src="pics/0.jpg" alt=""><figcaption class="meta">Ghats — Reflections</figcaption></figure>
        </div>
      </section>

      <!-- repeats -->
      <section class="gallery-section" data-caption="The Golden Evening">
        <div class="row">
          <figure class="tile"><img src="pics/0.jpg" alt=""><figcaption class="meta">Ghats — Evening Glow</figcaption></figure>
          <figure class="tile"><img src="pics/2.jpg" alt=""><figcaption class="meta">Aerial — City Lights</figcaption></figure>
          <figure class="tile"><img src="pics/me.jpg" alt=""><figcaption class="meta">Street — People</figcaption></figure>
          <figure class="tile"><img src="pics/1.jpg" alt=""><figcaption class="meta">Wedding — Ceremony</figcaption></figure>
        </div>
      </section>

      <section class="gallery-section" data-caption="Riverside Moments">
        <div class="row">
          <figure class="tile"><img src="pics/1.jpg" alt=""><figcaption class="meta">Ritual — Lamps</figcaption></figure>
          <figure class="tile"><img src="pics/0.jpg" alt=""><figcaption class="meta">Boats — Morning</figcaption></figure>
          <figure class="tile"><img src="pics/2.jpg" alt=""><figcaption class="meta">Sunset — Silhouette</figcaption></figure>
          <figure class="tile"><img src="pics/me.jpg" alt=""><figcaption class="meta">Market — Colors</figcaption></figure>
        </div>
      </section>
    </div>

    <footer>
      <p>Want a custom album or prints? <a href="contact.html">Contact us</a> for pricing and delivery.</p>
    </footer>
  </main>

  <div id="row-caption" class="row-caption" aria-live="polite" role="status" aria-atomic="true"></div>
  <div id="expander-root" aria-hidden="true"></div>

  <script>
  (function(){
    const sections = Array.from(document.querySelectorAll('.gallery-section'));
    const rows = Array.from(document.querySelectorAll('.row'));
    const tiles = Array.from(document.querySelectorAll('.tile'));
    const expanderRoot = document.getElementById('expander-root');
    const rowCaption = document.getElementById('row-caption');
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    function randomEffect(){
      const arr = ['effect-slide','effect-rotate','effect-fade'];
      return arr[Math.floor(Math.random()*arr.length)];
    }
    function captionForSection(sec){
      return sec.getAttribute('data-caption') || (sec.querySelector('.meta') ? sec.querySelector('.meta').textContent.trim() : 'Gallery');
    }

    function createExpanderForImage(src){
      expanderRoot.innerHTML='';
      const exp=document.createElement('div'); exp.className='expander';
      const base=document.createElement('div'); base.className='layer base'; base.style.backgroundImage=`url("${src}")`;
      const blur=document.createElement('div'); blur.className='layer blur'; blur.style.backgroundImage=`url("${src}")`;
      const glaze=document.createElement('div'); glaze.className='layer glaze'; glaze.style.backgroundImage=`url("${src}")`;
      exp.append(base,blur,glaze);
      expanderRoot.appendChild(exp);
      requestAnimationFrame(()=>exp.classList.add('show'));
    }
    function removeExpander(){
      const exp = expanderRoot.querySelector('.expander');
      if(!exp) return;
      exp.classList.remove('show');
      setTimeout(()=>{ expanderRoot.innerHTML=''; }, 3000);
    }

    const tileObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const img = entry.target.querySelector('img');
        if (!img) return;
        if(entry.isIntersecting && entry.intersectionRatio > 0.5){
          const src = img.src;
          const ex = expanderRoot.querySelector('.expander .layer.base');
          if(!ex || ex.style.backgroundImage.indexOf(src) === -1){
            createExpanderForImage(src);
          }
        } else {
          const still = tiles.some(t => {
            const r = t.getBoundingClientRect();
            return r.top < (window.innerHeight * 0.8) && r.bottom > (window.innerHeight * 0.2);
          });
          if(!still) removeExpander();
        }
      });
    }, { threshold: [0.35, 0.5, 0.75] });
    tiles.forEach(t => tileObserver.observe(t));

    const rowObserver = new IntersectionObserver((entries) => {
      // determine the single most visible section (highest ratio)
      const visible = entries.filter(e => e.isIntersecting).sort((a,b) => b.intersectionRatio - a.intersectionRatio);
      // clear active/effect classes
      rows.forEach(r => r.classList.remove('active','effect-slide','effect-rotate','effect-fade'));
      if(visible.length > 0){
        const bestSection = visible[0].target;
        const row = bestSection.querySelector('.row');
        row.classList.add('active');
        if(!prefersReduced){
          row.classList.add(randomEffect());
        }
        // update caption
        const text = captionForSection(bestSection);
        const count = bestSection.querySelectorAll('.tile').length;
        rowCaption.innerHTML = '';
        rowCaption.appendChild(document.createTextNode(text));
        const sub = document.createElement('span'); sub.className = 'sub'; sub.textContent = `${count} photos`;
        rowCaption.appendChild(sub);
        rowCaption.classList.add('show');
      } else {
        rowCaption.classList.remove('show');
      }
    }, {
      root: null,
      rootMargin: '0px',
      threshold: [0.4, 0.6, 0.82] // higher thresholds to avoid quick swaps
    });

    sections.forEach(s => rowObserver.observe(s));

    // remove effect class after animation so next activation can pick fresh effect
    rows.forEach(r => {
      r.addEventListener('animationend', () => {
        r.classList.remove('effect-slide','effect-rotate','effect-fade');
      });
    });

    // respect changes to reduced-motion
    const mm = window.matchMedia('(prefers-reduced-motion: reduce)');
    mm.addEventListener('change', () => {
      if(mm.matches){
        rows.forEach(r => r.classList.remove('effect-slide','effect-rotate','effect-fade'));
      }
    });

  })();
  </script>
</body>
</html>
